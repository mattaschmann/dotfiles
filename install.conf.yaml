- defaults:
    link:
      create: true
      relink: true
    shell:
      stdout: true
      stderr: true
      quiet: true

- clean: ['~']

- create:
    - ~/.local/bin
    - ~/opt
    - ~/.ssh

- link:
    ~/.config/alacritty/alacritty.toml: alacritty/alacritty.toml
    ~/.config/nvim/init.lua: nvim/init.lua
    ~/.config/nvim/lua: nvim/lua
    ~/.config/nvim/vimscripts: nvim/vimscripts
    ~/.config/nvim/snippets:
      path: nvim/snippets
      force: true
    ~/.ctags.d: universal_ctags
    ~/.dotfiles: ''
    ~/.ignore: rg/.ignore
    ~/.jsbeautifyrc: jsbeautify/.jsbeautifyrc
    ~/.tigrc: tig/.tigrc
    ~/.tmux.conf: tmux/.tmux.conf
    ~/.urlview: urlview/.urlview
    ~/.zprofile: zsh/.zprofile
    ~/.zsh_plugins.txt: zsh/.zsh_plugins.txt
    ~/.zshrc:
      path: zsh/.zshrc
      force: true
    ~/scripts: scripts/
    # WSL only
    # ~/.local/bin/xdg-open: ~/.local/bin/wsl-open

- shell:
    - description: Installing submodules
      command: git submodule update --init --recursive
    - description: Add special terminfos so we can use italics
      command: |
        tic terminfo/xterm-256color.terminfo
        tic terminfo/tmux.terminfo
        tic terminfo/xterm-256color.terminfo

    - description: Install brew packages (osx only)
      command: |
        if ! command -v brew &> /dev/null
        then
          echo "brew not found"
          echo "see: https://brew.sh/"
          exit 1
        else
          brew bundle
        fi
    - description: Install rust packages
      command: |
        if ! command -v cargo &> /dev/null
        then
          echo "cargo not found"
          echo "see: https://www.rust-lang.org/learn/get-started"
          exit 1
        else
          cargo install cargo-update
          cargo install ripgrep
          cargo install bat
          cargo install exa
          cargo install fd-find
          cargo install starship --locked
          cargo install zoxide --locked
          cargo install --locked yazi-fm yazi-cli
          cargo install tree-sitter-cli
        fi
    - description: Check for existence of desired commands
      command: |
        /bin/bash check_cmd.sh docker "https://docs.docker.com/engine/install/ubuntu/"
        /bin/bash check_cmd.sh pyenv "https://github.com/pyenv/pyenv"
        /bin/bash check_cmd.sh fnm "https://github.com/Schniz/fnm"
        /bin/bash check_cmd.sh starship "https://starship.rs/"
        /bin/bash check_cmd.sh fzf "https://github.com/junegunn/fzf"
        /bin/bash check_cmd.sh pdm "https://pdm-project.org/en/latest/"
        /bin/bash check_cmd.sh yazi "https://yazi-rs.github.io/"
        /bin/bash check_cmd.sh wsl-open "https://github.com/4U6U57/wsl-open"
        /bin/bash check_cmd.sh brew "https://brew.sh/"
    - description: Check for existence of desired directories, in the case we can't check the command
      command: |
        /bin/bash check_dir.sh ~/.tmux/plugins/tpm "https://github.com/tmux-plugins/tpm"
        /bin/bash check_dir.sh ~/.antidote "https://github.com/mattmc3/antidote"
        /bin/bash check_dir.sh ~/.oh-my-zsh "https://ohmyz.sh/"
